{"version":3,"sources":["views/coupon/AddCoupon.js"],"names":["axios","require","default","schema","yup","shape","couponType","required","productId","couponCode","value","stateId","AddCoupon","useForm","mode","resolver","yupResolver","register","control","handleSubmit","errors","formState","useHistory","useState","error","setError","loading","isFeatured","setIsFeatured","categoryImage","setCategoryImage","buttonText","buttonLink","description","setDescription","Date","startDate","setStartDate","states","setStates","products","setProducts","jwtToken","sessionStorage","getItem","useEffect","get","headers","then","response","data","catch","message","xs","sm","onSubmit","e","formData","FormData","append","categoryName","className","htmlFor","name","color","defaultValue","rules","render","field","type","placeholder","autoComplete","variant","onChange","target","files","custom","id","map","item","index","title","xl","state","checked","rows","disabled"],"mappings":"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","file":"static/js/185.779c64b6.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport {\r\n    CCard,\r\n    CCardBody,\r\n    CCardHeader,\r\n    CCol,\r\n    CForm,\r\n    CFormGroup,\r\n    CFormText,\r\n    CInput,\r\n    CInputFile,\r\n    CInputGroup,\r\n    CLabel,\r\n    CRow,\r\n    CSelect,\r\n    CTextarea,\r\n} from '@coreui/react'\r\n// import CIcon from '@coreui/icons-react'\r\n// import { DocsLink } from 'src/reusable'\r\nimport DatePicker from 'react-date-picker';\r\nimport { yupResolver } from '@hookform/resolvers/yup';\r\nimport * as yup from 'yup';\r\nimport { useForm, Controller } from 'react-hook-form';\r\nimport { useHistory } from 'react-router';\r\nimport Switch from \"react-switch\";\r\nconst axios = require('axios').default;\r\n\r\nconst schema = yup.object().shape({\r\n    couponType: yup.string().required(),\r\n    productId: yup.string().required(),\r\n    couponCode: yup.string().required(),\r\n    value: yup.string().required(),\r\n    stateId: yup.string().required(),\r\n});\r\n\r\nconst AddCoupon = () => {\r\n    const { register, control, handleSubmit, formState: { errors } } = useForm({ mode: 'all', resolver: yupResolver(schema) });\r\n    let history = useHistory();\r\n    const [error, setError] = useState(null);\r\n    const [loading, setLoading] = useState(false);\r\n    const [isFeatured, setIsFeatured] = useState(true);\r\n    const [categoryImage, setCategoryImage] = useState('');\r\n    const [buttonText, setButtonText] = useState('');\r\n    const [buttonLink, setButtonLink] = useState('');\r\n    const [description, setDescription] = useState('');\r\n    const [startDate, setStartDate] = useState(new Date());\r\n    const [states, setStates] = useState([]);\r\n    const [products, setProducts] = useState([]);\r\n\r\n\r\n\r\n    let jwtToken = sessionStorage.getItem(\"token\");\r\n\r\n\r\n    //* description\r\n    const descriptionOnChange = (e) => {\r\n        setDescription(e.target.value);\r\n    }\r\n    //* button text\r\n    const buttonTextOnChange = (e) => {\r\n        setButtonText(e.target.value);\r\n    }\r\n    //* button text\r\n    const buttonLinkOnChange = (e) => {\r\n        setButtonLink(e.target.value);\r\n    }\r\n\r\n    //* category image\r\n    const couponImageOnChange = (e) => {\r\n        setCategoryImage(e.target.files[0]);\r\n    }\r\n\r\n    const onChangeIsFeatured = (e) => {\r\n        setIsFeatured(e);\r\n    }\r\n\r\n    const yearOnChange = (startDate) => {\r\n        setStartDate(startDate);\r\n    }\r\n\r\n    //* get state \r\n    const axiosCategories = () => {\r\n        axios.get('http://markbran.in/apis/admin/state', {\r\n            headers: {\r\n                \"auth-token\": jwtToken //the token is a variable which holds the token\r\n            }\r\n        })\r\n            .then(function (response) {\r\n                setStates(response.data.states);\r\n            })\r\n            .catch(function (error) {\r\n                if (error.response && error.response.data.message) {\r\n                    setError(error.response.data.message);\r\n                }\r\n            });\r\n    }\r\n    //* get products\r\n    const axiosProducts = () => {\r\n        axios.get(`http://markbran.in/apis/admin/products`, {\r\n            headers: {\r\n                'auth-token': jwtToken\r\n            }\r\n        })\r\n            .then(function (response) {\r\n                setProducts(response.data.products);\r\n            })\r\n            .catch(function (error) {\r\n                if (error.response && error.response.data.message) {\r\n                    setError(error.response.data.message);\r\n                } else {\r\n                    setError(\"Something went wrong!\");\r\n                }\r\n            });\r\n    }\r\n    useEffect(() => {\r\n        axiosCategories();\r\n        axiosProducts();\r\n    }, []);\r\n\r\n    const onHandlerSubmit = (e) => {\r\n        const formData = new FormData();\r\n        formData.append('status', isFeatured);\r\n        formData.append('title', e.categoryName);\r\n        formData.append('image', categoryImage);\r\n        formData.append('buttonText', buttonText);\r\n        formData.append('buttonLink', buttonLink);\r\n        formData.append('description', description);\r\n        // formData.append('status', 1);\r\n\r\n\r\n        setError(null);\r\n        // setLoading(true)\r\n\r\n        // axios.post('http://markbran.in/apis/admin/category', formData, {\r\n        //     headers: {\r\n        //         'Content-Type': 'multipart/form-data',\r\n        //         'auth-token': jwtToken\r\n        //     }\r\n        // })\r\n        //     .then(res => {\r\n        //         setLoading(false);\r\n        //         // setUserSession(response.data.token, response.data.user);\r\n        //         history.push('/categories')\r\n        //         console.log(res.response.data);\r\n        //     })\r\n        //     .catch(err => {\r\n        //         // console.log(err.response.data.message);\r\n        //         setLoading(false);\r\n        //         if (err.response && err.response.data.message) {\r\n        //             setError(err.response.data.message);\r\n        //         } else {\r\n        //             setError(\"Something went wrong!\");\r\n        //         }\r\n        //     });\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <CRow>\r\n                <CCol xs=\"12\" sm=\"12\">\r\n                    <CCard>\r\n                        <CCardHeader>\r\n                            Add Coupon\r\n                        </CCardHeader>\r\n                        <CCardBody>\r\n                            <CForm onSubmit={handleSubmit(onHandlerSubmit)}>\r\n                                <br />\r\n                                {\r\n                                    error &&\r\n                                    <p className=\"text-danger\">\r\n                                        {error}\r\n                                    </p>\r\n                                }\r\n                                <CRow>\r\n                                    <CCol xs=\"6\">\r\n                                        <CFormGroup>\r\n                                            <CLabel htmlFor=\"category\">Select coupon type</CLabel>\r\n                                            <CInputGroup className=\"mb-3\">\r\n                                                <CSelect name=\"couponType\" {...register(\"couponType\")}>\r\n                                                    <option value=\"\">\r\n                                                        Select coupon type\r\n                                                    </option>\r\n                                                    <option value=\"percentage\">\r\n                                                        Percentage\r\n                                                    </option>\r\n                                                    <option value=\"amount\">\r\n                                                        Amount\r\n                                                    </option>\r\n                                                </CSelect>\r\n\r\n                                            </CInputGroup>\r\n                                            <CFormText className=\"help-block text-danger\" color=\"red\">{errors.couponType && errors.couponType.message}</CFormText>\r\n                                        </CFormGroup>\r\n                                    </CCol>\r\n                                    <CCol xs=\"6\">\r\n                                        <CFormGroup>\r\n                                            <CLabel htmlFor=\"category\">Coupon Code</CLabel>\r\n                                            <CInputGroup className=\"mb-3\">\r\n                                                <Controller\r\n                                                    name=\"couponCode\"\r\n                                                    control={control}\r\n                                                    defaultValue={''}\r\n                                                    rules={{\r\n                                                        required: {\r\n                                                            value: true,\r\n                                                            message: \"Coupon code is required\"\r\n                                                        },\r\n                                                    }}\r\n                                                    render={({ field }) => <CInput {...field} type=\"text\" placeholder=\"Coupon code\" autoComplete=\"Coupon code\" />}\r\n                                                />\r\n                                            </CInputGroup>\r\n                                            <CFormText className=\"help-block text-danger\" color=\"red\">{errors.couponCode && errors.couponCode.message}</CFormText>\r\n                                        </CFormGroup>\r\n                                    </CCol>\r\n                                    \r\n                                </CRow>\r\n                                <CRow>\r\n                                    <CCol xs=\"6\">\r\n                                        <CLabel htmlFor=\"category\">Image</CLabel>\r\n                                        <CInputGroup className=\"mb-3\">\r\n                                            <CLabel htmlFor=\"image\" variant=\"custom-file\">\r\n                                                Choose image...\r\n                                            </CLabel>\r\n                                            <CInputFile onChange={couponImageOnChange} custom id=\"image\" type=\"file\" />\r\n                                        </CInputGroup>\r\n                                    </CCol>\r\n                                    <CCol xs=\"6\">\r\n                                        <CFormGroup>\r\n                                            <CLabel htmlFor=\"category\">Select product</CLabel>\r\n                                            <CInputGroup className=\"mb-3\">\r\n                                                <CSelect name=\"productId\" {...register(\"productId\")}>\r\n                                                    <option value=\"\">\r\n                                                        Select product\r\n                                                    </option>\r\n                                                    {products.map((item, index) =>\r\n                                                        <option key={index} value={item.id}>{item.title}</option>\r\n                                                    )}\r\n                                                </CSelect>\r\n\r\n                                            </CInputGroup>\r\n                                            <CFormText className=\"help-block text-danger\" color=\"red\">{errors.productId && errors.productId.message}</CFormText>\r\n                                        </CFormGroup>\r\n                                    </CCol>\r\n                                    \r\n                                    \r\n                                </CRow>\r\n                                <CRow>\r\n                                    <CCol xl=\"6\">\r\n                                        <CFormGroup>\r\n                                            <CLabel htmlFor=\"Button Text\">Value (Percentage/Amount)</CLabel>\r\n                                            <CInputGroup>\r\n                                                <CInput type=\"text\" {...register('value')} placeholder=\"Value (Percentage/Amount)\" autoComplete=\"value\" />\r\n                                            </CInputGroup>\r\n                                            <CFormText className=\"help-block text-danger\" color=\"red\">{errors.value && errors.value.message}</CFormText>\r\n                                        </CFormGroup>\r\n                                    </CCol>\r\n                                    <CCol xs=\"6\">\r\n                                        <CFormGroup>\r\n                                            <CLabel htmlFor=\"category\">Select state</CLabel>\r\n                                            <CInputGroup className=\"mb-3\">\r\n                                                <CSelect name=\"stateId\" {...register(\"stateId\")}>\r\n                                                    <option value=\"\">\r\n                                                        Select state\r\n                                                    </option>\r\n                                                    {states.map((item, index) => \r\n                                                        <option value={item.id}>\r\n                                                            {item.state}\r\n                                                        </option>\r\n                                                    )}\r\n                                                </CSelect>\r\n                                            </CInputGroup>\r\n                                            <CFormText className=\"help-block text-danger\" color=\"red\">{errors.stateId && errors.stateId.message}</CFormText>\r\n                                        </CFormGroup>\r\n                                    </CCol>\r\n                                </CRow>\r\n                                <CRow>\r\n                                    <CCol xl=\"6\">\r\n                                        <CFormGroup>\r\n                                            <CLabel htmlFor=\"category\">Status</CLabel>\r\n                                            <CInputGroup>\r\n                                                <Switch onChange={onChangeIsFeatured} checked={isFeatured} />\r\n                                            </CInputGroup>\r\n                                        </CFormGroup>\r\n                                    </CCol>\r\n                                    <CCol xl=\"6\">\r\n                                        <CFormGroup>\r\n                                            <CLabel htmlFor=\"Button Link\">Expiry Date</CLabel>\r\n                                            <CInputGroup>\r\n                                                <DatePicker\r\n                                                    onChange={yearOnChange}\r\n                                                    value={startDate}\r\n                                                />\r\n                                            </CInputGroup>\r\n                                        </CFormGroup>\r\n                                    </CCol>\r\n                                </CRow>\r\n                                <CRow>\r\n                                    <CCol xl=\"12\">\r\n                                        <CFormGroup>\r\n                                            <CLabel htmlFor=\"category\">Description</CLabel>\r\n                                            <CInputGroup>\r\n                                                <CTextarea\r\n                                                    // component=\"textarea\"\r\n                                                    id=\"content\"\r\n                                                    rows=\"3\"\r\n                                                    onChange={descriptionOnChange} value={description}\r\n                                                ></CTextarea>\r\n                                            </CInputGroup>\r\n                                        </CFormGroup>\r\n                                    </CCol>\r\n                                </CRow>\r\n                                \r\n                                <CRow>\r\n                                    <CCol xs=\"8\">\r\n                                        <button className=\"btn btn-success\" disabled={loading ? true : false} type=\"submit\">{loading ? 'Loading...' : 'Add Coupon'}</button>\r\n                                    </CCol>\r\n                                </CRow>\r\n                            </CForm>\r\n                        </CCardBody>\r\n                    </CCard>\r\n                </CCol>\r\n            </CRow>\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default AddCoupon\r\n"],"sourceRoot":""}